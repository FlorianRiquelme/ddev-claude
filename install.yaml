name: ddev-claude
ddev_version_constraint: '>= v1.24.0'

# Architecture: Dedicated claude container with firewalled network
# Web container remains unchanged

pre_install_actions:
  - |
    #ddev-description:Validating Docker supports NET_ADMIN capability
    docker run --rm --cap-add=NET_ADMIN alpine sh -c 'exit 0' || (echo "ERROR: Docker does not support NET_ADMIN capability." && exit 1)

project_files:
  # TBD - will include:
  # - docker-compose.claude.yaml (defines claude container)
  # - claude-build/ (Dockerfile for claude container with CLI + firewall tools)
  # - firewall/ (entrypoint, whitelist, healthcheck scripts)
  # - commands/host/claude (ddev claude command)

removal_actions:
  - |
    #ddev-description:Removing addon files
    rm -rf .ddev/claude-build .ddev/firewall .ddev/docker-compose.claude.yaml .ddev/commands/host/claude 2>/dev/null || true
